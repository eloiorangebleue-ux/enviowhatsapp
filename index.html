<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Env√≠o WhatsApp</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Poppins', sans-serif; margin: 0; padding: 0; background: #f9f9f9; color: #333; }
    header { background: #25D366; color: #fff; padding: 1rem; text-align: center; }
    nav { display: flex; justify-content: center; background: #fff; }
    nav button { flex: 1; padding: 0.75rem; border: none; background: #eee; cursor: pointer; font-weight: 600; }
    nav button.active { background: #25D366; color: #fff; }
    main { padding: 1rem; }
    label { display: block; margin: 0.5rem 0 0.25rem; font-weight: 600; }
    input, select, textarea { width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 4px; }
    button { margin-top: 1rem; padding: 0.75rem 1rem; border: none; border-radius: 4px; background: #25D366; color: #fff; cursor: pointer; font-weight: 600; }
    .hidden { display: none; }
    ul { list-style: none; padding: 0; }
    li { background: #fff; margin: 0.5rem 0; padding: 0.5rem; border-radius: 4px; display: flex; justify-content: space-between; align-items: center; }
    .actions button { margin-left: 0.5rem; background: #e33; }
    .actions button.edit { background: #f0ad4e; }
  </style>
</head>
<body>

  <header>
    <h1>Env√≠o WhatsApp</h1>
  </header>

  <nav>
    <button id="tab-send" class="active">Enviar WhatsApp</button>
    <button id="tab-config">Configurar Mensajes</button>
  </nav>

  <main>
    <!-- Enviar WhatsApp -->
    <section id="section-send">
      <label>Tu c√≥digo de acceso
        <input type="text" id="code-input" placeholder="Ej: GYM-XM3L0K" />
      </label>
      <button id="btn-load">Cargar datos</button>

      <label>Nombre completo
        <input type="text" id="nombre" required />
      </label>
      <label>N√∫mero de tel√©fono
        <input type="tel" id="telefono" required />
      </label>
      <label>Selecciona plantilla
        <select id="plantilla-select">
          <option value="">-- Nuevo mensaje --</option>
        </select>
      </label>
      <label>Mensaje
        <textarea id="mensaje" rows="4"></textarea>
      </label>
      <button id="btn-preview">Previsualizar mensaje</button>

      <h3>Previsualizaci√≥n:</h3>
      <div id="preview">Completa los campos para ver la previsualizaci√≥n...</div>
      <p>üì± El mensaje se enviar√° al n√∫mero que introduzcas.</p>
    </section>

    <!-- Configurar Mensajes -->
    <section id="section-config" class="hidden">
      <label>Nueva plantilla
        <input type="text" id="new-plantilla" placeholder="Texto de la plantilla" />
      </label>
      <button id="btn-add">A√±adir plantilla</button>

      <h3>Plantillas disponibles:</h3>
      <ul id="lista-plantillas"></ul>
    </section>
  </main>

  <script>
    // Elementos
    const tabSend = document.getElementById('tab-send');
    const tabConfig = document.getElementById('tab-config');
    const sectionSend = document.getElementById('section-send');
    const sectionConfig = document.getElementById('section-config');

    const codeInput = document.getElementById('code-input');
    const btnLoad = document.getElementById('btn-load');

    const nombreEl = document.getElementById('nombre');
    const telefonoEl = document.getElementById('telefono');
    const plantillaSelect = document.getElementById('plantilla-select');
    const mensajeEl = document.getElementById('mensaje');
    const btnPreview = document.getElementById('btn-preview');
    const previewEl = document.getElementById('preview');

    const newPlantillaEl = document.getElementById('new-plantilla');
    const btnAdd = document.getElementById('btn-add');
    const listaPlantillasEl = document.getElementById('lista-plantillas');

    let plantillas = [];

    // Cambio de pesta√±as
    tabSend.addEventListener('click', () => {
      tabSend.classList.add('active');
      tabConfig.classList.remove('active');
      sectionSend.classList.remove('hidden');
      sectionConfig.classList.add('hidden');
    });
    tabConfig.addEventListener('click', () => {
      tabConfig.classList.add('active');
      tabSend.classList.remove('active');
      sectionConfig.classList.remove('hidden');
      sectionSend.classList.add('hidden');
      renderLista();
    });

    // Cargar desde localStorage
    btnLoad.addEventListener('click', () => {
      const code = codeInput.value.trim();
      if (!code) return alert('Introduce un c√≥digo de acceso');
      const saved = localStorage.getItem('plantillas_' + code);
      plantillas = saved ? JSON.parse(saved) : [];
      renderSelect();
      alert('Datos cargados correctamente');
    });

    // A√±adir plantilla
    btnAdd.addEventListener('click', () => {
      const text = newPlantillaEl.value.trim();
      if (!text) return;
      plantillas.push(text);
      save();
      newPlantillaEl.value = '';
      renderLista();
      renderSelect();
    });

    // Guardar en localStorage
    function save() {
      const code = codeInput.value.trim();
      if (!code) return alert('Introduce un c√≥digo para guardar');
      localStorage.setItem('plantillas_' + code, JSON.stringify(plantillas));
    }

    // Renderizar lista de Configuraci√≥n
    function renderLista() {
      listaPlantillasEl.innerHTML = '';
      plantillas.forEach((text, i) => {
        const li = document.createElement('li');
        li.textContent = text;
        const actions = document.createElement('div');
        actions.className = 'actions';
        const btnEdit = document.createElement('button');
        btnEdit.textContent = '‚úèÔ∏è';
        btnEdit.className = 'edit';
        btnEdit.onclick = () => {
          const nuevo = prompt('Editar plantilla:', text);
          if (nuevo !== null) {
            plantillas[i] = nuevo.trim() || text;
            save();
            renderLista();
            renderSelect();
          }
        };
        const btnDel = document.createElement('button');
        btnDel.textContent = 'üóëÔ∏è';
        btnDel.onclick = () => {
          plantillas.splice(i, 1);
          save();
          renderLista();
          renderSelect();
        };
        actions.appendChild(btnEdit);
        actions.appendChild(btnDel);
        li.appendChild(actions);
        listaPlantillasEl.appendChild(li);
      });
    }

    // Renderizar select de Env√≠o
    function renderSelect() {
      plantillaSelect.innerHTML = '<option value="">-- Nuevo mensaje --</option>';
      plantillas.forEach((text, i) => {
        const opt = document.createElement('option');
        opt.value = i;
        opt.textContent = text;
        plantillaSelect.appendChild(opt);
      });
    }

    // Selecci√≥n de plantilla
    plantillaSelect.addEventListener('change', () => {
      const idx = plantillaSelect.value;
      mensajeEl.value = idx === '' ? '' : plantillas[idx];
    });

    // Previsualizar mensaje
    btnPreview.addEventListener('click', () => {
      const nombre = nombreEl.value.trim();
      const tel = telefonoEl.value.trim();
      const msg = mensajeEl.value.trim();
      if (!nombre || !tel || !msg) {
        return alert('Rellena nombre, tel√©fono y mensaje.');
      }
      previewEl.textContent = `Hola ${nombre},\n\n${msg}`;
    });
  </script>

</body>
</html>
